var api=require("api"),win=require("window"),read=function(){var e=Ti.Database.open("igDB");console.log("open the DB"),e.execute("CREATE TABLE IF NOT EXISTS igTBL (id INTEGER PRIMARY KEY, username TEXT, image TEXT)"),console.log("creat table");for(var a=e.execute("SELECT * FROM igTBL"),i=[];a.isValidRow();)i.push({username:a.fieldByName("username"),image:a.fieldByName("image")}),a.next();a.close(),e.close(),win.buildUI(i)};exports.read=read,exports.saveToCloud=function(e){for(i=0,j=e.length;j>i;i++)Cloud.Objects.create({classname:"instagram",fields:{username:e[i].username,image:e[i].url}},function(e){e.success?console.log("saved!"):alert("cant save")})},exports.save=function(e){var a=Ti.Database.open("igDB");for(a.execute("CREATE TABLE IF NOT EXISTS igTBL (id INTEGER PRIMARY KEY, username TEXT, image TEXT)"),i=0,j=e.length;j>i;i++)a.execute("INSERT INTO igTBL (username,image) VALUES (?,?)",e[i].username,e[i].images);a.getLastInsertRowId();a.close(),read()};