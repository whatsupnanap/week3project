var api=require("api"),win=require("window"),read=function(){var e=Ti.Database.open("igDB");console.log("open the DB"),e.execute("CREATE TABLE IF NOT EXISTS igTBL (id INTEGER PRIMARY KEY, username TEXT, image TEXT)"),console.log("creat table");for(var r=e.execute("SELECT * FROM igTBL"),o=[];r.isValidRow();)o.push({username:r.fieldByName("username"),image:r.fieldByName("image")}),r.next();r.close(),e.close(),win.buildUI(o)};exports.read=read,exports.saveToCloud=function(e){for(i=0,j=e.length;j>i;i++)Cloud.Objects.create({classname:"instagram",fields:{username:e[i].username,image:e[i].url}},function(e){e.success?console.log("saved!"):alert("cant save")})},exports.save=function(e){var r=Ti.Database.open("igDB");for(r.execute("CREATE TABLE IF NOT EXISTS igTBL (id INTEGER PRIMARY KEY, username TEXT, image TEXT)"),i=0,j=e.length;j>i;i++)r.execute("INSERT INTO igTBL (username,image) VALUES (?,?)",e[i].username,e[i].images);r.getLastInsertRowId();r.close(),read()};